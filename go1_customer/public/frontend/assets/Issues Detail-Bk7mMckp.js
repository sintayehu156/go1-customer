var g=(v,s,d)=>new Promise((e,m)=>{var f=o=>{try{c(d.next(o))}catch(l){m(l)}},b=o=>{try{c(d.throw(o))}catch(l){m(l)}},c=o=>o.done?e(o.value):Promise.resolve(o.value).then(f,b);c((d=d.apply(v,s)).next())});import{L as R}from"./LeftSidebar-DIvzo2_q.js";import{_ as L,b as P,r as n,c as U,q as T,o as F,e as V,f as r,g as u,n as x,t as H,v as q,x as S,u as J,y as M,h as y,i as h}from"./index-CMQgrs3Q.js";import{_ as A}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-CtZvVT_t.js";import{a as G}from"./FormControl.vue_vue_type_script_setup_true_lang-DxvH2exx.js";import"./index-mgISJYoh.js";const K={components:{LeftSidebar:R,Breadcrumbs:A,Button:P,FormControl:G},setup(){const v=J(),s=M(),d=n(!1),e=n(!1),m=n(""),f=n(""),b=n(""),c=n(""),o=n(""),l=n(""),i=n([]),_=n([]),j=U({url:"go1_customer.go1_customer.api.api.get_issues",method:"get"}),C=n([{label:"Issues",route:{name:"issue"}},{label:"New",route:{}}]),z=[{label:"Open",value:"Open"},{label:"Closed",value:"Closed"},{label:"Replied",value:"Replied"},{label:"On Hold",value:"On Hold"},{label:"Resolved",value:"Resolved"}],w=()=>g(this,null,function*(){try{const t=s.params.id,a=(yield j.fetch()).find(N=>N.name===t);a&&(m.value=a.name,l.value=a.subject,f.value=a.status,b.value=a.description.replace(/<\/?[^>]+>/gi,""),o.value=a.customer,c.value=a.priority)}catch(t){console.error("Error fetching issue details:",t)}}),O=()=>{e.value=!0},B=()=>{e.value=!1,w()},I=()=>g(this,null,function*(){const t=s.params.id;if(!t)return;const p={subject:l.value,status:f.value,priority:c.value,description:b.value,customer:o.value};try{if(!(yield fetch(`/api/resource/Issue/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})).ok)throw new Error("Error updating issue");e.value=!1,v.push({name:"issue"})}catch(a){console.error("Error updating issue:",a)}}),E=()=>g(this,null,function*(){try{const t=yield fetch('/api/resource/Customer?fields=["name"]');if(!t.ok)throw new Error("Network response was not ok");const p=yield t.json();i.value=p.data.map(a=>a.name)||[]}catch(t){console.error("Error fetching customers:",t)}}),k=()=>g(this,null,function*(){try{const t=yield fetch('/api/resource/Issue Priority?fields=["name"]');if(!t.ok)throw new Error("Network response was not ok");const p=yield t.json();_.value=p.data.map(a=>a.name)||[],console.log("pr",p)}catch(t){console.error("Error fetching customers:",t)}}),D=()=>{d.value=!d.value};return T(m,t=>{C.value[1].label=t}),F(()=>g(this,null,function*(){yield w(),yield E(),yield k()})),{isSidebarCollapsed:d,priorityOption:_,isEditing:e,name:m,status:f,subject:l,description:b,priority:c,customer:o,customOption:i,toggleSidebar:D,breadcrumbsList:C,statusOptions:z,optionsCustomer:E,optionsPriority:k,startEditing:O,cancelEditing:B,submitChanges:I}}},Q={class:"head-content"},W={class:"border-b bg-white px-5 py-6.5 pb-[2.625rem] sm:px-5 mb-12"},X={class:"main-content"},Y={class:"bg-white shadow-md rounded-lg p-6 space-y-6 pb-[2.625rem]"},Z={class:"float-left mb-1 text-9xl font-bold text-gray-800 -mt-2",style:{"font-size":"1.85rem"}},$={class:"text-9xl font-bold text-gray-600",style:{"font-size":"1rem"}},ee={class:"float-right mb-1"},se={class:"p-2"},te={key:0,class:"float-right flex gap-4"};function oe(v,s,d,e,m,f){const b=y("Breadcrumbs"),c=y("LeftSidebar"),o=y("Button"),l=y("FormControl");return h(),V("div",null,[r("div",{class:x(["head-layout",{collapsed:e.isSidebarCollapsed}])},[r("div",Q,[r("header",W,[u(b,{items:e.breadcrumbsList,class:"float-left"},null,8,["items"])])])],2),r("div",{class:x(["layout",{collapsed:e.isSidebarCollapsed}])},[u(c,{isCollapsed:e.isSidebarCollapsed,onToggle:e.toggleSidebar},null,8,["isCollapsed","onToggle"]),r("div",X,[r("div",Y,[r("div",Z,[s[5]||(s[5]=r("p",null,"Issue",-1)),r("p",$,H(e.subject),1)]),r("div",ee,[e.isEditing?S("",!0):(h(),q(o,{key:0,variant:"solid",theme:"gray",size:"md",label:"Edit",disabled:!1,onClick:e.startEditing,class:""},null,8,["onClick"]))]),s[6]||(s[6]=r("div",{class:"border-b pb-7 pt-10"},null,-1)),r("div",se,[u(l,{type:"text",size:"md",variant:"subtle",placeholder:"subject",disabled:!e.isEditing,label:"Subject",modelValue:e.subject,"onUpdate:modelValue":s[0]||(s[0]=i=>e.subject=i),class:"mb-5"},null,8,["disabled","modelValue"]),u(l,{type:"select",size:"md",options:e.statusOptions,variant:"subtle",placeholder:"status",disabled:!e.isEditing,label:"Status",modelValue:e.status,"onUpdate:modelValue":s[1]||(s[1]=i=>e.status=i),class:"mb-5 text-gray-1000 text-base"},null,8,["options","disabled","modelValue"]),u(l,{type:"select",size:"md",variant:"subtle",options:e.customOption,disabled:!e.isEditing,label:"Customer",modelValue:e.customer,"onUpdate:modelValue":s[2]||(s[2]=i=>e.customer=i),class:"mb-5"},null,8,["options","disabled","modelValue"]),u(l,{type:"textarea",size:"md",variant:"subtle",placeholder:"Placeholder",disabled:!e.isEditing,label:"Description",modelValue:e.description,"onUpdate:modelValue":s[3]||(s[3]=i=>e.description=i),class:"mb-5"},null,8,["disabled","modelValue"]),u(l,{type:"select",size:"md",variant:"subtle",options:e.priorityOption,placeholder:"Placeholder",disabled:!e.isEditing,label:"Priority",modelValue:e.priority,"onUpdate:modelValue":s[4]||(s[4]=i=>e.priority=i),class:"mb-5"},null,8,["options","disabled","modelValue"]),e.isEditing?(h(),V("div",te,[u(o,{variant:"subtle",theme:"gray",size:"md",label:"Discard",disabled:!1,onClick:e.cancelEditing},null,8,["onClick"]),u(o,{variant:"solid",theme:"gray",size:"md",label:"Submit",disabled:!1,onClick:e.submitChanges},null,8,["onClick"])])):S("",!0)])])])],2)])}const ce=L(K,[["render",oe],["__scopeId","data-v-14117bb6"]]);export{ce as default};
